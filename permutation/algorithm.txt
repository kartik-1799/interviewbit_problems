Used heapPermutation and added some modification.
